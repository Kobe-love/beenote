import{d as y,u as C,r,y as m,o as L,c as x,e as g,w as u,E,h as _,f as M,i as q,j as N,b,x as B,p as G,_ as S}from"./index-CnMzNVNF.js";const T={class:"oauth-callback"},V={class:"card-header"},A={class:"callback-content"},H=y({__name:"OAuthCallback",setup(O){const l=M(),h=q(),o=C(),c=r(!0),p=r(!1),i=r("正在处理登录请求..."),d=r("请稍候"),f=m(()=>({wecom:"企业微信",feishu:"飞书",dingtalk:"钉钉",github:"GitHub",google:"Google",gitlab:"GitLab"})[l.query.state]||"未知平台"),v=m(()=>`${f.value}登录`),k=async()=>{var n;try{const e=l.query.code,s=l.query.authCode,a=(n=l.query.state)==null?void 0:n.toLowerCase();if(console.log("code:",e),console.log("authCode:",s),console.log("state:",a),!e||!a||!s&&a==="dingtalk"&&a!=="github")throw new Error("缺少必要的参数");let t;switch(a){case"wecom":t=await o.wecomLogin(e);break;case"feishu":t=await o.feishuLogin(e);break;case"dingtalk":t=await o.dingtalkLogin(s);break;case"github":t=await o.githubLogin(e);break;case"google":t=await o.googleLogin(e);break;case"gitlab":t=await o.gitlabLogin(e);break;default:throw new Error("未知的登录类型")}c.value=!1,i.value="登录成功",d.value="正在跳转...",setTimeout(()=>{h.push("/")},1e3)}catch(e){c.value=!1,p.value=!0,i.value="登录失败",d.value=e.message||"请稍后重试",E.error(e.message||"登录失败")}},w=()=>{h.push("/")};return L(()=>{k()}),(n,e)=>{const s=_("el-button"),a=_("el-result"),t=_("el-card");return N(),x("div",T,[g(t,{class:"callback-card"},{header:u(()=>[b("div",V,[b("h2",null,B(v.value),1)])]),default:u(()=>[b("div",A,[g(a,{icon:c.value?"info":p.value?"error":"success",title:i.value,"sub-title":d.value},{extra:u(()=>[g(s,{type:"primary",onClick:w,disabled:c.value},{default:u(()=>e[0]||(e[0]=[G(" 返回首页 ")])),_:1},8,["disabled"])]),_:1},8,["icon","title","sub-title"])])]),_:1})])}}}),j=S(H,[["__scopeId","data-v-f72a3de9"]]);export{j as default};

import{d as q,r as u,q as F,c as I,b as R,e as t,w as l,E as A,s as H,G as m,f as r,H as P,o as x,h as s,I as Q,j as f,N as S,P as z,Q as J,_ as K}from"./index-Df5Rugzl.js";import{c as L,j as O,k as W,l as X}from"./index-DzkZSsWB.js";const Y={class:"auth-groups-container"},Z={class:"header"},ee=q({__name:"Groups",setup(te){const y=u([]),_=u(!1),v=u(!1),i=u(!1),d=u(null),c=u(),a=reactive({name:"",description:""}),C={name:[{required:!0,message:"请输入分组名称",trigger:"blur"}]},b=async()=>{_.value=!0;try{const o=await L();y.value=o.data}catch(o){console.error(o),m.error("获取分组列表失败")}finally{_.value=!1}},w=()=>{c.value&&c.value.resetFields(),a.name="",a.description="",d.value=null},G=()=>{w(),i.value=!0},B=o=>{d.value=o,a.name=o.name,a.description=o.description||"",i.value=!0},E=async()=>{c.value&&await c.value.validate(async o=>{if(o){v.value=!0;try{d.value?await O(d.value.id,a):await W(a),m.success("保存成功"),i.value=!1,b()}catch(e){console.error(e),m.error("保存失败")}finally{v.value=!1}}})},h=async o=>{try{await J.confirm("确定要删除该分组吗？此操作不可恢复","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await X(o.id),m.success("删除成功"),await b()}catch(e){e!=="cancel"&&(console.error(e),m.error("删除失败"))}};return F(()=>{b()}),(o,e)=>{const N=r("el-icon"),p=r("el-button"),g=r("el-table-column"),D=r("el-button-group"),M=r("el-table"),V=r("el-input"),k=r("el-form-item"),T=r("el-form"),U=r("el-dialog"),$=P("loading");return x(),I("div",Y,[R("div",Z,[t(p,{type:"primary",onClick:G},{default:l(()=>[t(N,null,{default:l(()=>[t(s(Q))]),_:1}),e[4]||(e[4]=f("新建分组 "))]),_:1})]),A((x(),H(M,{data:y.value,stripe:""},{default:l(()=>[t(g,{prop:"name",label:"名称"}),t(g,{prop:"description",label:"描述"}),t(g,{label:"操作",width:"200",fixed:"right"},{default:l(({row:n})=>[t(D,null,{default:l(()=>[t(p,{type:"primary",icon:s(S),onClick:j=>B(n)},{default:l(()=>e[5]||(e[5]=[f(" 编辑 ")])),_:2},1032,["icon","onClick"]),t(p,{type:"danger",icon:s(z),onClick:j=>h(n)},{default:l(()=>e[6]||(e[6]=[f(" 删除 ")])),_:2},1032,["icon","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[$,_.value]]),t(U,{title:d.value?"编辑分组":"新建分组",modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=n=>i.value=n),width:"500px",onClose:w},{footer:l(()=>[t(p,{onClick:e[2]||(e[2]=n=>i.value=!1)},{default:l(()=>e[7]||(e[7]=[f("取消")])),_:1}),t(p,{type:"primary",onClick:E,loading:v.value},{default:l(()=>e[8]||(e[8]=[f(" 确定 ")])),_:1},8,["loading"])]),default:l(()=>[t(T,{model:s(a),rules:C,ref_key:"formRef",ref:c,"label-width":"80px"},{default:l(()=>[t(k,{label:"名称",prop:"name"},{default:l(()=>[t(V,{modelValue:s(a).name,"onUpdate:modelValue":e[0]||(e[0]=n=>s(a).name=n),placeholder:"请输入分组名称"},null,8,["modelValue"])]),_:1}),t(k,{label:"描述",prop:"description"},{default:l(()=>[t(V,{modelValue:s(a).description,"onUpdate:modelValue":e[1]||(e[1]=n=>s(a).description=n),type:"textarea",rows:3,placeholder:"请输入分组描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}}),ae=K(ee,[["__scopeId","data-v-d7bdf200"]]);export{ae as default};

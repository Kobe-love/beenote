import{_ as R}from"./logo-FnfcyM4Z.js";import{d as X,f as Z,i as $,r as O,q as P,h as _,j as r,c as y,e,w as t,F as w,s as M,t as m,v as ae,p as B,x as b,_ as ee,u as ne,y as le,o as se,b as n,k as z,z as C,A as K}from"./index-DUSGohFq.js";import{g as re}from"./index-D3N4F8Vq.js";const ue={class:"tag-nav"},ce=X({__name:"TagNav",setup(te){const x=Z(),T=$(),p=O([]),v=f=>f.path===x.path,c=async f=>{const{path:d,meta:a,params:l,name:i}=f;if(a!=null&&a.title){let k=a.title;if(f.name==="NoteView"&&l.id)try{k=(await re(l.id)).data.title}catch(g){console.error("获取笔记标题失败:",g)}const V={title:k,path:d,params:l,name:i};p.value.some(g=>g.path===d)||p.value.push(V)}},I=f=>{const d=p.value;let a=x.path;a===f&&d.forEach((l,i)=>{if(l.path===f){const k=d[i+1]||d[i-1];k&&(a=k.path)}}),p.value=d.filter(l=>l.path!==f),a&&a!==x.path&&T.push(a)},G=f=>{f.name&&f.params?T.push({name:f.name,params:f.params}):T.push(f.path)};return P(()=>x.path,async()=>{await c(x)},{immediate:!0}),(f,d)=>{const a=_("el-tag"),l=_("el-scrollbar");return r(),y("div",ue,[e(l,{class:"scroll-container"},{default:t(()=>[(r(!0),y(w,null,M(p.value,i=>(r(),m(a,{key:i.path,type:v(i)?"primary":"info",effect:v(i)?"dark":"plain",class:ae({active:v(i)}),round:"",closable:"",onClick:k=>G(i),onClose:k=>I(i.path)},{default:t(()=>[B(b(i.title),1)]),_:2},1032,["type","effect","class","onClick","onClose"]))),128))]),_:1})])}}}),W=ee(ce,[["__scopeId","data-v-65bfde30"]]),ie={class:"header-content"},de={class:"header-right"},_e={href:"https://qm.qq.com/cgi-bin/qm/qr?k=a_y5qjuIfBYZHkhGg4JTZqGjTk3KUI5T&jump_from=webapi&authKey=qJpb8UQWFJcxKBdT/zq9kGBqiMxOm9k3TkfYeAtaVtHAbKbIfxMiGBolmP+aWa5b",target:"_blank"},pe={href:"https://github.com/X-Mars/beenote",target:"_blank"},fe={class:"user-dropdown"},me={class:"username"},he={class:"sub-header"},ge={class:"footer-content"},be={class:"header-right"},ve={href:"https://qm.qq.com/cgi-bin/qm/qr?k=a_y5qjuIfBYZHkhGg4JTZqGjTk3KUI5T&jump_from=webapi&authKey=qJpb8UQWFJcxKBdT/zq9kGBqiMxOm9k3TkfYeAtaVtHAbKbIfxMiGBolmP+aWa5b",target:"_blank"},ke={href:"https://github.com/X-Mars/beenote",target:"_blank"},ye={class:"user-dropdown"},we={class:"username"},xe={class:"footer-content"},qe=X({__name:"Layout",setup(te){const x=Z(),T=$(),p=ne(),v=O(localStorage.getItem("layoutMode")||"horizontal"),c=d=>(d.children||[]).filter(a=>{var l;return!((l=a.meta)!=null&&l.hidden)}),I=le(()=>T.options.routes.filter(a=>a.path!=="/login"&&a.children).filter(a=>{var l,i;return(l=a.meta)!=null&&l.roles?a.meta.roles.includes(((i=p.user)==null?void 0:i.role)||""):!0}));P(v,d=>{localStorage.setItem("layoutMode",d)});const G=d=>{d==="logout"?(p.logout(),T.push("/login")):d==="switchLayout"&&(v.value=v.value==="vertical"?"horizontal":"vertical")},f=async()=>{try{await p.initialize()}catch(d){console.error("获取用户信息失败:",d),p.clearUser(),T.push("/login")}};return se(()=>{p.token&&f()}),(d,a)=>{const l=_("el-icon"),i=_("el-menu-item"),k=_("el-sub-menu"),V=_("el-menu"),g=_("el-avatar"),A=_("el-tooltip"),N=_("ArrowDown"),F=_("el-dropdown-item"),j=_("SwitchButton"),S=_("el-dropdown-menu"),U=_("el-dropdown"),D=_("el-header"),H=_("router-view"),J=_("el-main"),L=_("el-footer"),oe=_("el-aside"),Q=_("el-container");return r(),m(Q,{class:"layout-container layout-wrapper"},{default:t(()=>[v.value==="horizontal"?(r(),y(w,{key:0},[e(D,{height:"60px",class:"horizontal-header"},{default:t(()=>[n("div",ie,[a[2]||(a[2]=n("div",{class:"logo horizontal"},[n("img",{src:R,alt:"logo",class:"logo-img"}),n("h1",null,"蜜蜂笔记")],-1)),e(V,{router:!0,"default-active":z(x).path,mode:"horizontal",class:"horizontal-menu"},{default:t(()=>[(r(!0),y(w,null,M(I.value,o=>(r(),y(w,{key:o.path},[c(o).length>1?(r(),m(k,{key:0,index:o.path},{title:t(()=>{var s;return[e(l,null,{default:t(()=>{var u,h;return[(u=o.meta)!=null&&u.icon?(r(),m(C((h=o.meta)==null?void 0:h.icon),{key:0})):K("",!0)]}),_:2},1024),n("span",null,b((s=o.meta)==null?void 0:s.title),1)]}),default:t(()=>[(r(!0),y(w,null,M(c(o),s=>(r(),m(i,{key:s.path,index:s.path},{default:t(()=>{var u;return[e(l,null,{default:t(()=>{var h,q;return[(h=s.meta)!=null&&h.icon?(r(),m(C((q=s.meta)==null?void 0:q.icon),{key:0})):K("",!0)]}),_:2},1024),n("span",null,b((u=s.meta)==null?void 0:u.title),1)]}),_:2},1032,["index"]))),128))]),_:2},1032,["index"])):(r(),m(i,{key:1,index:c(o).length===1?c(o)[0].path:o.path},{default:t(()=>{var s,u;return[e(l,null,{default:t(()=>{var h,q,Y,E;return[(c(o).length===1?(h=c(o)[0].meta)!=null&&h.icon:(q=o.meta)!=null&&q.icon)?(r(),m(C(c(o).length===1?(Y=c(o)[0].meta)==null?void 0:Y.icon:(E=o.meta)==null?void 0:E.icon),{key:0})):K("",!0)]}),_:2},1024),n("span",null,b(c(o).length===1?(s=c(o)[0].meta)==null?void 0:s.title:(u=o.meta)==null?void 0:u.title),1)]}),_:2},1032,["index"]))],64))),128))]),_:1},8,["default-active"]),n("div",de,[n("a",_e,[e(A,{content:"加入QQ摸鱼群",placement:"bottom"},{default:t(()=>[e(g,{size:32,src:"/src/assets/qq.png",style:{"margin-right":"16px","background-color":"#fff"}})]),_:1})]),n("a",pe,[e(A,{content:"访问 火星小刘的 GitHub 仓库",placement:"bottom"},{default:t(()=>[e(g,{size:32,src:"/src/assets/github.png",style:{"margin-right":"16px","background-color":"#fff"}})]),_:1})]),e(U,{onCommand:G},{dropdown:t(()=>[e(S,null,{default:t(()=>[e(F,{command:"switchLayout"},{default:t(()=>[e(l,null,{default:t(()=>[(r(),m(C(v.value==="horizontal"?"Expand":"Fold")))]),_:1}),a[0]||(a[0]=B(" 切换布局 "))]),_:1}),e(F,{command:"logout"},{default:t(()=>[e(l,null,{default:t(()=>[e(j)]),_:1}),a[1]||(a[1]=B(" 退出登录 "))]),_:1})]),_:1})]),default:t(()=>{var o,s,u;return[n("span",fe,[e(g,{size:32,src:((o=z(p).user)==null?void 0:o.avatar)||"/src/assets/logo.png",style:{"background-color":"#fff"}},null,8,["src"]),n("span",me,b(((s=z(p).user)==null?void 0:s.name)||((u=z(p).user)==null?void 0:u.username)),1),e(l,null,{default:t(()=>[e(N)]),_:1})])]}),_:1})])])]),_:1}),n("div",he,[e(W)]),e(J,{class:"main-content"},{default:t(()=>[e(H)]),_:1}),e(L,{height:"30px",class:"footer"},{default:t(()=>[n("div",ge,[n("span",null,[B("© "+b(new Date().getFullYear())+" ",1),a[3]||(a[3]=n("a",{href:"https://github.com/X-Mars",target:"_blank",class:"author-link"},"火星小刘",-1))])])]),_:1})],64)):(r(),y(w,{key:1},[e(oe,{width:"200px",class:"sidebar"},{default:t(()=>[a[4]||(a[4]=n("div",{class:"logo"},[n("img",{src:R,alt:"logo",class:"logo-img"}),n("h1",null,"蜜蜂笔记")],-1)),e(V,{router:!0,"default-active":z(x).path,class:"menu"},{default:t(()=>[(r(!0),y(w,null,M(I.value,o=>(r(),y(w,{key:o.path},[c(o).length>1?(r(),m(k,{key:0,index:o.path},{title:t(()=>{var s;return[e(l,null,{default:t(()=>{var u;return[(r(),m(C((u=o.meta)==null?void 0:u.icon)))]}),_:2},1024),n("span",null,b((s=o.meta)==null?void 0:s.title),1)]}),default:t(()=>[(r(!0),y(w,null,M(c(o),s=>(r(),m(i,{key:s.path,index:s.path},{default:t(()=>{var u;return[e(l,null,{default:t(()=>{var h;return[(r(),m(C((h=s.meta)==null?void 0:h.icon)))]}),_:2},1024),n("span",null,b((u=s.meta)==null?void 0:u.title),1)]}),_:2},1032,["index"]))),128))]),_:2},1032,["index"])):(r(),m(i,{key:1,index:c(o).length===1?c(o)[0].path:o.path},{default:t(()=>{var s,u;return[e(l,null,{default:t(()=>{var h,q;return[(r(),m(C(c(o).length===1?(h=c(o)[0].meta)==null?void 0:h.icon:(q=o.meta)==null?void 0:q.icon)))]}),_:2},1024),n("span",null,b(c(o).length===1?(s=c(o)[0].meta)==null?void 0:s.title:(u=o.meta)==null?void 0:u.title),1)]}),_:2},1032,["index"]))],64))),128))]),_:1},8,["default-active"])]),_:1}),e(Q,null,{default:t(()=>[e(D,{class:"vertical-header"},{default:t(()=>[n("div",be,[n("a",ve,[e(A,{content:"加入QQ摸鱼群",placement:"bottom"},{default:t(()=>[e(g,{size:32,src:"/src/assets/qq.png",style:{"margin-right":"16px","background-color":"#fff"}})]),_:1})]),n("a",ke,[e(A,{content:"访问 火星小刘的 GitHub 仓库",placement:"bottom"},{default:t(()=>[e(g,{size:32,src:"/src/assets/github.png",style:{"margin-right":"16px","background-color":"#fff"}})]),_:1})]),e(U,{onCommand:G},{dropdown:t(()=>[e(S,null,{default:t(()=>[e(F,{command:"switchLayout"},{default:t(()=>[e(l,null,{default:t(()=>[(r(),m(C(v.value==="vertical"?"Fold":"Expand")))]),_:1}),a[5]||(a[5]=B(" 切换布局 "))]),_:1}),e(F,{command:"logout"},{default:t(()=>[e(l,null,{default:t(()=>[e(j)]),_:1}),a[6]||(a[6]=B(" 退出登录 "))]),_:1})]),_:1})]),default:t(()=>{var o,s,u;return[n("span",ye,[e(g,{size:32,src:((o=z(p).user)==null?void 0:o.avatar)||"/src/assets/logo.png",style:{"background-color":"#fff"}},null,8,["src"]),n("span",we,b(((s=z(p).user)==null?void 0:s.name)||((u=z(p).user)==null?void 0:u.username)),1),e(l,null,{default:t(()=>[e(N)]),_:1})])]}),_:1})]),e(W)]),_:1}),e(J,null,{default:t(()=>[e(H)]),_:1}),e(L,{height:"30px",class:"footer"},{default:t(()=>[n("div",xe,[n("span",null,[B("© "+b(new Date().getFullYear())+" ",1),a[7]||(a[7]=n("a",{href:"https://github.com/X-Mars",target:"_blank",class:"author-link"},"火星小刘",-1))])])]),_:1})]),_:1})],64))]),_:1})}}}),Be=ee(qe,[["__scopeId","data-v-eb7dc867"]]);export{Be as default};

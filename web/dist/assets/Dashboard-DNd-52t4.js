import{a as D,b as F}from"./index-DlkQAjXX.js";import{d as k,u as A,x as W,r as f,p as U,y as z,c as x,e as a,w as t,f as u,g as E,o as _,F as R,q as V,b as s,j as h,B as C,s as w,t as B,z as O,v as S,_ as $}from"./index-CAh1O9RG.js";const N={class:"dashboard"},M={class:"card-content"},I={class:"card-icon"},P={class:"card-info"},j={class:"title"},q={class:"value"},G={class:"chart-header"},T=k({__name:"Dashboard",setup(H){E();const m=A();W(()=>m.user);const n=f("week"),c=f([{title:"笔记总数",value:0,type:"primary",icon:"Document",trend:0},{title:"分组总数",value:0,type:"success",icon:"FolderOpened",trend:0},{title:"今日活跃",value:0,type:"warning",icon:"User",trend:0},{title:"用户总数",value:0,type:"info",icon:"User",trend:0}]),v=async()=>{try{const[i,e]=await Promise.all([D({range:n.value}),F()]);console.log(e),c.value[0].value=i.data.total_notes,c.value[1].value=i.data.total_groups,c.value[2].value=e.data.active_users,c.value[3].value=e.data.total_users;const r=i.data.notes_charts;if(r.length>=2){const l=r[r.length-1].count,o=r[r.length-2].count;o>0&&(c.value[0].trend=Math.round((l-o)/o*100))}g.value={tooltip:{trigger:"axis",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#eee",borderWidth:1,textStyle:{color:"#666"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:r.map(l=>{if(n.value==="year"){const[o,p]=l.date.split("-");return`${o}年${p}月`}else if(n.value==="month"){const o=new Date(l.date);return`${o.getMonth()+1}/${o.getDate()}`}else{const o=new Date(l.date);return["周日","周一","周二","周三","周四","周五","周六"][o.getDay()]}})},yAxis:{type:"value",axisLine:{show:!1},splitLine:{lineStyle:{color:"#eee"}}},series:[{name:"笔记数量",type:"line",data:r.map(l=>l.count),smooth:n.value==="year"}]},y.value={color:["#409EFF","#67C23A","#E6A23C","#F56C6C","#909399"],tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#eee",borderWidth:1,textStyle:{color:"#666"}},legend:{orient:"vertical",right:"5%",top:"center",textStyle:{color:"#666"}},series:[{name:"分组分布",type:"pie",radius:["50%","70%"],center:["40%","50%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!0,fontSize:14,fontWeight:"bold"}},labelLine:{show:!1},data:i.data.groups_distribution}]}}catch(i){console.error("获取统计数据失败:",i)}};U(n,()=>{v()}),z(async()=>{await m.fetchUserInfo(),v()});const g=f({tooltip:{trigger:"axis",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#eee",borderWidth:1,textStyle:{color:"#666"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:["周一","周二","周三","周四","周五","周六","周日"],axisLine:{lineStyle:{color:"#ddd"}}},yAxis:{type:"value",axisLine:{show:!1},splitLine:{lineStyle:{color:"#eee"}}},series:[{name:"笔记数",type:"line",smooth:!0,data:[15,22,18,30,25,35,28],lineStyle:{width:3,color:"#409EFF"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(64, 158, 255, 0.2)"},{offset:1,color:"rgba(64, 158, 255, 0.05)"}]}},symbol:"circle",symbolSize:8}]}),y=f({color:["#409EFF","#67C23A","#E6A23C","#F56C6C","#909399"],tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#eee",borderWidth:1,textStyle:{color:"#666"}},legend:{orient:"vertical",right:"5%",top:"center",textStyle:{color:"#666"}},series:[{name:"分组分布",type:"pie",radius:["50%","70%"],center:["40%","50%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!0,fontSize:14,fontWeight:"bold"}},labelLine:{show:!1},data:[{value:35,name:"无数据"},{value:25,name:"学习"},{value:20,name:"生活"},{value:15,name:"娱乐"},{value:5,name:"其他"}]}]});return(i,e)=>{const r=u("el-icon"),l=u("el-card"),o=u("el-col"),p=u("el-row"),b=u("el-radio-button"),L=u("el-radio-group");return _(),x("div",N,[a(p,{gutter:20},{default:t(()=>[(_(!0),x(R,null,V(c.value,d=>(_(),w(o,{span:6,key:d.title},{default:t(()=>[a(l,{class:B(["data-card",d.type])},{default:t(()=>[s("div",M,[s("div",I,[a(r,null,{default:t(()=>[(_(),w(O(d.icon)))]),_:2},1024)]),s("div",P,[s("div",j,S(d.title),1),s("div",q,S(d.value),1)])])]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1}),a(p,{gutter:20,class:"chart-row"},{default:t(()=>[a(o,{span:16},{default:t(()=>[a(l,{class:"chart-card"},{header:t(()=>[s("div",G,[e[4]||(e[4]=s("h3",null,"笔记趋势",-1)),a(L,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=d=>n.value=d),size:"small"},{default:t(()=>[a(b,{label:"week"},{default:t(()=>e[1]||(e[1]=[h("本周")])),_:1}),a(b,{label:"month"},{default:t(()=>e[2]||(e[2]=[h("本月")])),_:1}),a(b,{label:"year"},{default:t(()=>e[3]||(e[3]=[h("全年")])),_:1})]),_:1},8,["modelValue"])])]),default:t(()=>[a(C,{option:g.value,height:"360px"},null,8,["option"])]),_:1})]),_:1}),a(o,{span:8},{default:t(()=>[a(l,{class:"chart-card"},{header:t(()=>e[5]||(e[5]=[s("div",{class:"chart-header"},[s("h3",null,"分组分布")],-1)])),default:t(()=>[a(C,{option:y.value,height:"360px"},null,8,["option"])]),_:1})]),_:1})]),_:1})])}}}),Q=$(T,[["__scopeId","data-v-149ba93e"]]);export{Q as default};

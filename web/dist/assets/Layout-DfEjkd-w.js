import{_ as J}from"./logo-FnfcyM4Z.js";import{d as P,u as Q,r as W,m as X,p as Y,q as Z,s as c,w as t,f as i,t as $,g as ee,o as l,c as v,e as n,b as r,h,F as y,v as S,x as w,j as z,y as g,z as L,_ as te}from"./index-Df5Rugzl.js";const ne={class:"header-content"},oe={class:"header-right"},ae={class:"user-dropdown"},le={class:"username"},se={class:"header-right"},ue={class:"user-dropdown"},re={class:"username"},de=P({__name:"Layout",setup(_e){const I=$(),B=ee(),m=Q(),k=W(localStorage.getItem("layoutMode")||"horizontal"),d=f=>(f.children||[]).filter(s=>{var _;return!((_=s.meta)!=null&&_.hidden)}),M=X(()=>B.options.routes.filter(s=>s.path!=="/login"&&s.children).filter(s=>{var _,x;return(_=s.meta)!=null&&_.roles?s.meta.roles.includes(((x=m.user)==null?void 0:x.role)||""):!0}));Y(k,f=>{localStorage.setItem("layoutMode",f)});const U=f=>{f==="logout"?(m.logout(),B.push("/login")):f==="switchLayout"&&(k.value=k.value==="vertical"?"horizontal":"vertical")},K=async()=>{try{await m.initialize()}catch(f){console.error("获取用户信息失败:",f),m.clearUser(),B.push("/login")}};return Z(()=>{m.token&&K()}),(f,s)=>{const _=i("el-icon"),x=i("el-menu-item"),V=i("el-sub-menu"),b=i("el-menu"),A=i("el-avatar"),D=i("ArrowDown"),C=i("el-dropdown-item"),F=i("SwitchButton"),N=i("el-dropdown-menu"),R=i("el-dropdown"),E=i("el-header"),j=i("router-view"),q=i("el-main"),O=i("el-aside"),T=i("el-container");return l(),c(T,{class:"layout-container"},{default:t(()=>[k.value==="horizontal"?(l(),v(y,{key:0},[n(E,{height:"60px",class:"horizontal-header"},{default:t(()=>[r("div",ne,[s[2]||(s[2]=r("div",{class:"logo horizontal"},[r("img",{src:J,alt:"logo",class:"logo-img"}),r("h1",null,"蜜蜂笔记")],-1)),n(b,{router:!0,"default-active":h(I).path,mode:"horizontal",class:"horizontal-menu"},{default:t(()=>[(l(!0),v(y,null,S(M.value,e=>(l(),v(y,{key:e.path},[d(e).length>1?(l(),c(V,{key:0,index:e.path},{title:t(()=>{var o;return[n(_,null,{default:t(()=>{var a,u;return[(a=e.meta)!=null&&a.icon?(l(),c(w((u=e.meta)==null?void 0:u.icon),{key:0})):L("",!0)]}),_:2},1024),r("span",null,g((o=e.meta)==null?void 0:o.title),1)]}),default:t(()=>[(l(!0),v(y,null,S(d(e),o=>(l(),c(x,{key:o.path,index:o.path},{default:t(()=>{var a;return[n(_,null,{default:t(()=>{var u,p;return[(u=o.meta)!=null&&u.icon?(l(),c(w((p=o.meta)==null?void 0:p.icon),{key:0})):L("",!0)]}),_:2},1024),r("span",null,g((a=o.meta)==null?void 0:a.title),1)]}),_:2},1032,["index"]))),128))]),_:2},1032,["index"])):(l(),c(x,{key:1,index:d(e).length===1?d(e)[0].path:e.path},{default:t(()=>{var o,a;return[n(_,null,{default:t(()=>{var u,p,G,H;return[(d(e).length===1?(u=d(e)[0].meta)!=null&&u.icon:(p=e.meta)!=null&&p.icon)?(l(),c(w(d(e).length===1?(G=d(e)[0].meta)==null?void 0:G.icon:(H=e.meta)==null?void 0:H.icon),{key:0})):L("",!0)]}),_:2},1024),r("span",null,g(d(e).length===1?(o=d(e)[0].meta)==null?void 0:o.title:(a=e.meta)==null?void 0:a.title),1)]}),_:2},1032,["index"]))],64))),128))]),_:1},8,["default-active"]),r("div",oe,[n(R,{onCommand:U},{dropdown:t(()=>[n(N,null,{default:t(()=>[n(C,{command:"switchLayout"},{default:t(()=>[n(_,null,{default:t(()=>[(l(),c(w(k.value==="horizontal"?"Expand":"Fold")))]),_:1}),s[0]||(s[0]=z(" 切换布局 "))]),_:1}),n(C,{command:"logout"},{default:t(()=>[n(_,null,{default:t(()=>[n(F)]),_:1}),s[1]||(s[1]=z(" 退出登录 "))]),_:1})]),_:1})]),default:t(()=>{var e,o;return[r("span",ae,[n(A,{size:32,class:"avatar"},{default:t(()=>{var a,u,p;return[z(g((p=((a=h(m).user)==null?void 0:a.name)||((u=h(m).user)==null?void 0:u.username))==null?void 0:p.charAt(0).toUpperCase()),1)]}),_:1}),r("span",le,g(((e=h(m).user)==null?void 0:e.name)||((o=h(m).user)==null?void 0:o.username)),1),n(_,null,{default:t(()=>[n(D)]),_:1})])]}),_:1})])])]),_:1}),n(q,null,{default:t(()=>[n(j)]),_:1})],64)):(l(),v(y,{key:1},[n(O,{width:"200px"},{default:t(()=>[s[3]||(s[3]=r("div",{class:"logo"},[r("img",{src:J,alt:"logo",class:"logo-img"}),r("h1",null,"蜜蜂笔记")],-1)),n(b,{router:!0,"default-active":h(I).path,class:"menu"},{default:t(()=>[(l(!0),v(y,null,S(M.value,e=>(l(),v(y,{key:e.path},[d(e).length>1?(l(),c(V,{key:0,index:e.path},{title:t(()=>{var o;return[n(_,null,{default:t(()=>{var a;return[(l(),c(w((a=e.meta)==null?void 0:a.icon)))]}),_:2},1024),r("span",null,g((o=e.meta)==null?void 0:o.title),1)]}),default:t(()=>[(l(!0),v(y,null,S(d(e),o=>(l(),c(x,{key:o.path,index:o.path},{default:t(()=>{var a;return[n(_,null,{default:t(()=>{var u;return[(l(),c(w((u=o.meta)==null?void 0:u.icon)))]}),_:2},1024),r("span",null,g((a=o.meta)==null?void 0:a.title),1)]}),_:2},1032,["index"]))),128))]),_:2},1032,["index"])):(l(),c(x,{key:1,index:d(e).length===1?d(e)[0].path:e.path},{default:t(()=>{var o,a;return[n(_,null,{default:t(()=>{var u,p;return[(l(),c(w(d(e).length===1?(u=d(e)[0].meta)==null?void 0:u.icon:(p=e.meta)==null?void 0:p.icon)))]}),_:2},1024),r("span",null,g(d(e).length===1?(o=d(e)[0].meta)==null?void 0:o.title:(a=e.meta)==null?void 0:a.title),1)]}),_:2},1032,["index"]))],64))),128))]),_:1},8,["default-active"])]),_:1}),n(T,null,{default:t(()=>[n(E,null,{default:t(()=>[r("div",se,[n(R,{onCommand:U},{dropdown:t(()=>[n(N,null,{default:t(()=>[n(C,{command:"switchLayout"},{default:t(()=>[n(_,null,{default:t(()=>[(l(),c(w(k.value==="vertical"?"Fold":"Expand")))]),_:1}),s[4]||(s[4]=z(" 切换布局 "))]),_:1}),n(C,{command:"logout"},{default:t(()=>[n(_,null,{default:t(()=>[n(F)]),_:1}),s[5]||(s[5]=z(" 退出登录 "))]),_:1})]),_:1})]),default:t(()=>{var e,o;return[r("span",ue,[n(A,{size:32,class:"avatar"},{default:t(()=>{var a,u,p;return[z(g((p=((a=h(m).user)==null?void 0:a.name)||((u=h(m).user)==null?void 0:u.username))==null?void 0:p.charAt(0).toUpperCase()),1)]}),_:1}),r("span",re,g(((e=h(m).user)==null?void 0:e.name)||((o=h(m).user)==null?void 0:o.username)),1),n(_,null,{default:t(()=>[n(D)]),_:1})])]}),_:1})])]),_:1}),n(q,null,{default:t(()=>[n(j)]),_:1})]),_:1})],64))]),_:1})}}}),pe=te(de,[["__scopeId","data-v-ae84628a"]]);export{pe as default};
